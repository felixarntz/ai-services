# AI Playground Data Store

Directory: `src/playground-page/store/`

This directory contains the Redux data store logic for the AI Playground page. It manages the state related to AI capabilities, service and model selection, message history, and other settings specific to the playground interface. The store is built using `@wordpress/data` and combines several smaller store configurations into a single, cohesive unit.

## Purpose

The primary purpose of the code within this directory is to:

- Manage the selection and availability of foundational and additional AI capabilities.
- Handle the selection of AI services and models, filtering them based on chosen capabilities.
- Store and manage the conversation messages, including user prompts, model responses, and error messages.
- Persist and retrieve message history and user preferences related to the playground.
- Manage model-specific parameters and system instructions.
- Handle function declarations for AI models that support function calling.
- Provide actions, selectors, and reducers for interacting with and updating the playground's state.

## Key Components

- **`capabilities.ts`**: Manages the state for available and selected AI capabilities (e.g., text generation, image generation, chat history). It defines actions to set foundational capabilities, toggle additional capabilities, and selectors to retrieve current and available capabilities.
- **`service-model.ts`**: Handles the state related to AI service and model selection. This includes storing the currently selected service and model, available services and models based on selected capabilities, model-specific configuration parameters, system instructions, and function declarations. It uses `@wordpress/preferences` to persist some of these settings.
- **`messages.ts`**: Manages the conversation history within the AI Playground. It includes logic for sending messages to the AI, receiving responses, handling errors, storing messages (potentially using `helpers.historyPersistence()` from `src/ai/`), and managing attachments associated with messages. It also handles uploading media generated by AI models.
- **`name.ts`**: Defines the unique store name (`STORE_NAME`) used to register this data store with `@wordpress/data`.
- **`index.ts`**: Combines the individual store configurations (`capabilitiesStoreConfig`, `serviceModelStoreConfig`, `messagesStoreConfig`) into a single store configuration using the `combineStoreConfigs` utility from `src/utils/`. It then creates and registers the Redux store using `createReduxStore` and `register` from `@wordpress/data`.

## Dependencies

- **`@wordpress/data`**: Used for creating and managing the Redux-like data store.
- **`@wordpress/preferences`**: Used for persisting user preferences, such as selected capabilities, service, model, and function declarations.
- **`@ai-services/ai`**: Provides enums, helpers, and the core AI store (`aiStore`) for interacting with AI services and models. This is referenced from `src/ai/`.
- **`memize`**: Used for memoizing selectors to optimize performance.
- **`../types`**: Contains TypeScript type definitions specific to the playground page, likely located in `src/playground-page/`.

## State Management

The store is divided into logical slices, each managing a specific aspect of the playground's state:

- **Capabilities**: Tracks which AI features are available and selected by the user.
- **Service/Model**: Manages the chosen AI provider, the specific model, and its configuration.
- **Messages**: Maintains the chat history, including user inputs, AI outputs, and any associated media or errors.

Actions are dispatched to update the state, and selectors are used by UI components to retrieve data from the store. Resolvers are used to fetch initial data, such as loading messages from cache or retrieving available capabilities.
